# 5.1 소스 코드 유출
 흔히 PHP언어에서 다른 코드를 자신의 코드 내에 포함시키기 위해 include, require, include_once, require_once 등을 사용하는데에 이 장에서는 include의 큰 문제점인 소스 코드 유출에 관련해서 알아보려고 합니다.

소스 코드 유출의 문제는 다음과 같은 상황때문에 발생을 합니다.
 - 인클루드 확장자로 .inc를 사용하는 경우
 - 웹 서버 루트에 인클루드를 지정한 경우
 - 아파치에서 .inc 파일에 대한 리소스 타입을 지정하지 않은 경우
 - 아파치의 DefaultType 설정이 text/plain인 경우
위 목록에 해당하면 URL을 통해서 include에 접근할 수 있습니다. 심한 경우에는 include를 PHP가 실행하지 않고 일반 텍스트로 처리한다면 사용자 브라우저에 소스 코드가 표시될 수도 있습니다.
```
###브라우저에 출력된 소스
<?php
$db_user = 'my_user';
$db_pass = 'my_pass';
$db_host = '127.0.0.1';

$db = mysql_connect($db_host, $db_user, $db_pass);
?>
```
이 문제를 해결하는 방법은 매우 쉽습니다. 응용프로그램에서 사용하는 모든 인클루드를 웹 서버 루트 바깥에 저장하도록 구성하면 됩니다. 실제로 가장 좋은 방법은 모두에게 공개될 수 있는 모든 파일은 웹 서버 루트 밑에 저장하는 것입니다.
 실제로 아파치를 업그레이드, PHP 지원을 설정하는 것을 잊어버리거나, 아파치 재시작시 업그레이드를 하면서 실수들이 많이 발생합니다. 그래서 가급적 웹 서버 루트 바깥에 PHP 코드를 저장하는 것이 안전합니다.

또한 몇 가지 지침들은 소스 코드 유출 가능성을 제한하기는 하지만 문제가 발생하는 근본 원인을 해결하지는 못합니다. 그래서 .inc를 PHP로 처리하도록 아파치를 설정하는 방법, include의 확장자를 .php로 하는 방법, .inc리소스에 대한 요청을 거부하도록 아파치를 설정하는 방법 등이 있습니다.
```
<Files ~"\.inc$">
    Order allow,deny
    Deny from all
</Files>
```
하지만 다시 한번 말하지만 가장 확실한 방법은 include 소스들을 웹 서버 바깥에 두는 것입니다.
