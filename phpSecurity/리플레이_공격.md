# 7.2 리플레이 공격
 
 프레젠테이션 공격으로 불리기도 하는 리플레이 공격(replay attack)은 정상적인 사용자가 액세스 권한이나 특별한 권한을 얻기 위해 전송한 데이터를 공격자가 재전송하는 종류의 모든 공격을 뜻합니다.

 패스워드 스니핑과 마찬가지로 리플레이 공격을 차단하려면 데이터 유출에 대해 살펴봐야 합니다. 리플레이 공격을 차단하려면 접근이 제한된 리소스에 대한 권한을 얻기 위해 사용되는 데이터를 공격자가 캡처하지 못하게 하거나 어렵게 해야합니다.

 - 접근이 제한된 리소스에 대한 액세스를 기억하는 데이터의 사용
 - 접근이 제한된 리소스에 대한 액세스를 제공하는 데이터의 유출(임시 액세스만 제공하는 데이터를 사용하는 경우도 포함)

 즉, 접근이 제한된 리소스에 대해서는 임시 액세스를 허용하는 데이터만 사용해야 하며 가능한 이 데이터가 유출되지 않게 해야 합니다. 일반적인 가이드라인이 있지만 이는 여러분이 구현할 방법에 대한 모델만 제공하는 것을 잊지 말아야 합니다. 

 첫번째는 너무 자주 지켜지지 않아 놀랍기까지 한 것인데, 많은 개발자들이 중요한 데이터가 유출되지 않도록 하는 것에만 치중하고 액세스 유지를 위해 사용하는 데이터의 유출 위험은 간과한다는 것입니다. 예를 들어, 인증 폼에 사용되는 비밀번호의 해시를 생성하기 위해 클라이언트 기반 스크립트를 사용하는 경우를 생각해봐야 합니다. 이 경우에 비밀번호 자체는 노출되지 않고 비밀번호에 기반한 해시만 노출됩니다. 이런 방법을 사용하면 사용자의 본래 비밀번호는 보호할 수 있다. 그러나, 이 방법의 문제점은 공격자가 인증받기 위해 이 인증 과정을 리플레이하는 것과 같은 리플레이 공격에는 여전히 취약하다는 점입니다. 사용자가 비밀번호를 변경하지 않는 한 계속 사용할 수 있습니다.
```
<?php
    $auth = $username . md5($password);
    setcookie('auth', $cookie);
?>
```
 비인증 사용자가 인증 쿠키를 제시하면 쿠키에 저장된 비밀번호의 해시가 테이터베이스에 저장된 비밀번호의 해시와 일치하는지 조사합니다. 만약 일치한다면 사용자는 인증을 통과합니다. 이 방법의 문제점은 쿠키가 유출되면 굉장히 위험하다는 것입니다. 쿠키를 캡쳐하는데 성공하면 공격자는 계속해서 액세스 공격이 가능해집니다. 정상적인 사용자의 쿠키가 만료되더라도 정상적인 사용자가 비밀번호를 변경할 때까지 공격자는 인증에 필요한 쿠키를 항상 제시할 수 있으며 인증은 성공합니다.
 로그인 정보를 기억하는 것보다 나은 구현은 액세스 권한을 임시로 부여하는 데이터를 사용하는 것입니다.

